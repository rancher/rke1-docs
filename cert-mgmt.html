<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-cert-mgmt/cert-mgmt">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Certificate Management | RKE1</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://rke.docs.rancher.com/cert-mgmt"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Certificate Management | RKE1"><meta data-rh="true" name="description" content="Available as of v0.2.0"><meta data-rh="true" property="og:description" content="Available as of v0.2.0"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://rke.docs.rancher.com/cert-mgmt"><link data-rh="true" rel="alternate" href="https://rke.docs.rancher.com/cert-mgmt" hreflang="en"><link data-rh="true" rel="alternate" href="https://rke.docs.rancher.com/cert-mgmt" hreflang="x-default"><link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-57KS2MW",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script><link rel="stylesheet" href="/assets/css/styles.7d95b67f.css">
<link rel="preload" href="/assets/js/runtime~main.d49a85cb.js" as="script">
<link rel="preload" href="/assets/js/main.5731013e.js" as="script">
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-57KS2MW" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-horizontal-rke.svg" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo-horizontal-rke.svg" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><div class="searchBox_ZlJk"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Quick Links</a><ul class="dropdown__menu"><li><a href="https://github.com/rancher/rke" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/rancher/rke1-docs" target="_blank" rel="noopener noreferrer" class="dropdown__link">Docs GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">More from SUSE</a><ul class="dropdown__menu"><li><a href="https://www.rancher.com" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__rancher">Rancher<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://elemental.docs.rancher.com/" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__elemental">Elemental<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://epinio.io/" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__epinio">Epinio<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://fleet.rancher.io/" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__fleet">Fleet<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://harvesterhci.io" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__harvester">Harvester<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://opensource.suse.com" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__suse">More Projects...<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Overview of RKE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/os">Requirements</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/installation">RKE Kubernetes Installation</a><button aria-label="Toggle the collapsible sidebar category &#x27;RKE Kubernetes Installation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/upgrades">Upgrades</a><button aria-label="Toggle the collapsible sidebar category &#x27;Upgrades&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/kubeconfig">Kubeconfig File</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/etcd-snapshots">Backups and Disaster Recovery</a><button aria-label="Toggle the collapsible sidebar category &#x27;Backups and Disaster Recovery&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/cert-mgmt">Certificate Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/managing-clusters">Adding and Removing Nodes</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/config-options">Kubernetes Configuration Options</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kubernetes Configuration Options&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/example-yamls">Example Cluster.ymls</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/troubleshooting">Troubleshooting</a><button aria-label="Toggle the collapsible sidebar category &#x27;Troubleshooting&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Certificate Management</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Certificate Management</h1></header><p><em>Available as of v0.2.0</em></p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p> This is not &quot;TLS Certificates management in Kubernetes&quot;. Refer the <a href="https://kubernetes.io/docs/tasks/tls/managing-tls-in-a-cluster/" target="_blank" rel="noopener noreferrer">Kubernetes documentation</a> and RKE <a href="/example-yamls">cluster.yaml example</a> for more details.</p></div></div><p>Certificates are an important part of Kubernetes clusters and are used for all Kubernetes cluster components. RKE has a <code>rke cert</code> command to help work with certificates.</p><ul><li><a href="#generating-certificate-signing-requests-csrs-and-keys">Ability to generate certificate sign requests for the Kubernetes components</a></li><li><a href="#certificate-rotation">Rotate Auto-Generated Certificates</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="generating-certificate-signing-requests-csrs-and-keys">Generating Certificate Signing Requests (CSRs) and Keys<a href="#generating-certificate-signing-requests-csrs-and-keys" class="hash-link" aria-label="Direct link to Generating Certificate Signing Requests (CSRs) and Keys" title="Direct link to Generating Certificate Signing Requests (CSRs) and Keys">​</a></h2><p>If you want to create and sign the certificates by a real Certificate Authority (CA), you can use RKE to <a href="/installation/certs#generating-certificate-signing-requests-csrs-and-keys">generate a set of Certificate Signing Requests (CSRs) and keys</a>.</p><p>You can use the CSRs and keys to sign the certificates by a real CA. After the certificates are signed, these custom certificates can be used by RKE to as <a href="/installation/certs">custom certificates</a> for the Kubernetes cluster.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="certificate-rotation">Certificate Rotation<a href="#certificate-rotation" class="hash-link" aria-label="Direct link to Certificate Rotation" title="Direct link to Certificate Rotation">​</a></h2><p>By default, Kubernetes clusters require certificates and RKE will automatically generate certificates for the clusters. Rotating these certificates are important before the certificates expire as well as if a certificate is compromised.</p><p>After the certificates are rotated, the Kubernetes components are automatically restarted. Certificates can be rotated for the following services:</p><ul><li>etcd</li><li>kubelet (node certificate)</li><li>kubelet (serving certificate, if <a href="/config-options/services#kubelet-options">enabled</a>)</li><li>kube-apiserver</li><li>kube-proxy</li><li>kube-scheduler</li><li>kube-controller-manager</li></ul><p>RKE has the ability to rotate the auto-generated certificates with some simple commands:</p><ul><li>Rotating all service certificates while using the same CA</li><li>Rotating a certificate on an individual service while using the same CA</li><li>Rotating the CA and all service certificates</li></ul><p>Whenever you&#x27;re trying to rotate certificates, the <code>cluster.yml</code> that was used to deploy the Kubernetes cluster is required. You can reference a different location for this file by using the <code>--config</code> option when running <code>rke cert rotate</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rotating-all-service-certificates-while-using-the-same-ca">Rotating all Service Certificates while using the same CA<a href="#rotating-all-service-certificates-while-using-the-same-ca" class="hash-link" aria-label="Direct link to Rotating all Service Certificates while using the same CA" title="Direct link to Rotating all Service Certificates while using the same CA">​</a></h3><p>To rotate the service certificates for all the Kubernetes services, run the following command, i.e. <code>rke cert rotate</code>. After all the service certificates are rotated, these services will automatically be restarted to start using the new certificate.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ rke cert rotate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0000] Initiating Kubernetes cluster</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0000] Rotating Kubernetes cluster certificates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0000] [certificates] Generating Kubernetes API server certificates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0000] [certificates] Generating Kube Controller certificates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0000] [certificates] Generating Kube Scheduler certificates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0001] [certificates] Generating Kube Proxy certificates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0001] [certificates] Generating Node certificate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0001] [certificates] Generating admin certificates and kubeconfig</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0001] [certificates] Generating Kubernetes API server proxy client certificates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0001] [certificates] Generating etcd-xxxxx certificate and key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0001] [certificates] Generating etcd-yyyyy certificate and key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0002] [certificates] Generating etcd-zzzzz certificate and key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0002] Successfully Deployed state file at [./cluster.rkestate]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0002] Rebuilding Kubernetes cluster with rotated certificates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">.....</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0050] [worker] Successfully restarted Worker Plane..</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rotating-a-certificate-on-an-individual-service-while-using-the-same-ca">Rotating a Certificate on an Individual Service while using the same CA<a href="#rotating-a-certificate-on-an-individual-service-while-using-the-same-ca" class="hash-link" aria-label="Direct link to Rotating a Certificate on an Individual Service while using the same CA" title="Direct link to Rotating a Certificate on an Individual Service while using the same CA">​</a></h3><p>To rotate the certificate for an individual Kubernetes service, use the <code>--service</code> option when rotating certificates to specify the service. After the specified Kubernetes service has had its certificate rotated, it is automatically restarted to start using the new certificate.</p><p>Example of rotating the certificate for only the <code>kubelet</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ rke cert rotate --service kubelet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0000] Initiating Kubernetes cluster</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0000] Rotating Kubernetes cluster certificates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0000] [certificates] Generating Node certificate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0000] Successfully Deployed state file at [./cluster.rkestate]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0000] Rebuilding Kubernetes cluster with rotated certificates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">.....</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0033] [worker] Successfully restarted Worker Plane..</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rotating-the-ca-and-all-service-certificates">Rotating the CA and all service certificates<a href="#rotating-the-ca-and-all-service-certificates" class="hash-link" aria-label="Direct link to Rotating the CA and all service certificates" title="Direct link to Rotating the CA and all service certificates">​</a></h3><p>If the CA certificate needs to be rotated, you are required to rotate all the services certificates as they need to be signed with the newly rotated CA certificate. To include rotating the CA with the service certificates, add the <code>--rotate-ca</code> option. After the CA and all the service certificates are rotated, these services will automatically be restarted to start using the new certificate.</p><p>Rotating the CA certificate will result in restarting other system pods, that will also use the new CA certificate. This includes:</p><ul><li>Networking pods (canal, calico and flannel)</li><li>Ingress Controller pods</li><li>KubeDNS pods</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ rke cert rotate --rotate-ca</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0000] Initiating Kubernetes cluster</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0000] Rotating Kubernetes cluster certificates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0000] [certificates] Generating CA kubernetes certificates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0000] [certificates] Generating Kubernetes API server aggregation layer requestheader client CA certificates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0000] [certificates] Generating Kubernetes API server certificates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0000] [certificates] Generating Kube Controller certificates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0000] [certificates] Generating Kube Scheduler certificates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0000] [certificates] Generating Kube Proxy certificates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0000] [certificates] Generating Node certificate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0001] [certificates] Generating admin certificates and kubeconfig</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0001] [certificates] Generating Kubernetes API server proxy client certificates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0001] [certificates] Generating etcd-xxxxx certificate and key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0001] [certificates] Generating etcd-yyyyy certificate and key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0001] [certificates] Generating etcd-zzzzz certificate and key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0001] Successfully Deployed state file at [./cluster.rkestate]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO[0001] Rebuilding Kubernetes cluster with rotated certificates</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/rancher/rke1-docs/edit/main/docs/cert-mgmt/cert-mgmt.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-08-18T09:45:29.000Z">Aug 18, 2023</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/etcd-snapshots/troubleshooting"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Troubleshooting</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/managing-clusters"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Adding and Removing Nodes</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#generating-certificate-signing-requests-csrs-and-keys" class="table-of-contents__link toc-highlight">Generating Certificate Signing Requests (CSRs) and Keys</a></li><li><a href="#certificate-rotation" class="table-of-contents__link toc-highlight">Certificate Rotation</a><ul><li><a href="#rotating-all-service-certificates-while-using-the-same-ca" class="table-of-contents__link toc-highlight">Rotating all Service Certificates while using the same CA</a></li><li><a href="#rotating-a-certificate-on-an-individual-service-while-using-the-same-ca" class="table-of-contents__link toc-highlight">Rotating a Certificate on an Individual Service while using the same CA</a></li><li><a href="#rotating-the-ca-and-all-service-certificates" class="table-of-contents__link toc-highlight">Rotating the CA and all service certificates</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 SUSE Rancher. All Rights Reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.d49a85cb.js"></script>
<script src="/assets/js/main.5731013e.js"></script>
</body>
</html>